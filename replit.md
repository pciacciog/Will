# Replit.md

## Overview

This is a full-stack web application for group goal accountability, built with React, Express, and PostgreSQL. The app allows users to form "Inner Circles" of 2-4 people who help each other achieve meaningful goals through structured "wills" (goal commitments) and daily progress tracking. The application uses Replit's authentication system and is designed to be deployed on the Replit platform.

## System Architecture

### Frontend Architecture
- **Framework**: React with TypeScript
- **Routing**: Wouter for client-side routing
- **State Management**: TanStack Query (React Query) for server state management
- **UI Framework**: Shadcn/ui components built on Radix UI primitives
- **Styling**: Tailwind CSS with custom design tokens
- **Build Tool**: Vite for development and build processes

### Backend Architecture
- **Framework**: Express.js with TypeScript
- **Database ORM**: Drizzle ORM for type-safe database operations
- **Authentication**: Replit's OIDC-based authentication system with Passport.js
- **Session Management**: Express sessions with PostgreSQL storage
- **API Design**: RESTful API endpoints with JSON responses

### Database Architecture
- **Database**: PostgreSQL (via Neon serverless)
- **Schema Management**: Drizzle migrations and schema definitions
- **Connection**: Connection pooling with Neon serverless driver

## Key Components

### Authentication System
- Uses Replit's OIDC authentication flow
- Session-based authentication with PostgreSQL session storage
- Mandatory user and session tables for Replit Auth compliance
- Protected routes with authentication middleware

### Inner Circle Management
- Users can create or join circles using 6-character invite codes
- Circle size limited to 2-4 members
- Each user can only be in one circle at a time

### Will (Goal) System
- Structured goal commitments with start/end dates
- Status tracking: pending, scheduled, active, completed
- Individual member commitments within shared goals
- Progress acknowledgment and tracking features

### Daily Progress Tracking
- Members can log daily progress on active goals
- Progress sharing and accountability features
- Timeline-based progress visualization

## Data Flow

1. **Authentication Flow**: User authenticates via Replit OAuth â†’ Session created in PostgreSQL â†’ User data stored/updated
2. **Circle Creation**: User creates circle â†’ Generates unique invite code â†’ Other users join via code
3. **Goal Setting**: Circle member creates "will" â†’ Other members add commitments â†’ Goal becomes active based on schedule
4. **Progress Tracking**: Members log daily progress â†’ Progress shared with circle â†’ Acknowledgments and support provided

## External Dependencies

### Core Dependencies
- **@neondatabase/serverless**: PostgreSQL database connection
- **drizzle-orm**: Database ORM and query builder
- **express**: Web server framework
- **passport**: Authentication middleware
- **openid-client**: OAuth/OIDC client implementation
- **@tanstack/react-query**: Client-side state management
- **@radix-ui/**: UI component primitives
- **tailwindcss**: CSS framework

### Development Dependencies
- **vite**: Build tool and dev server
- **tsx**: TypeScript execution for development
- **esbuild**: Production bundling

## Deployment Strategy

- **Platform**: Replit with autoscale deployment
- **Build Process**: Vite builds client assets, esbuild bundles server
- **Environment**: Node.js 20 with PostgreSQL 16
- **Port Configuration**: Internal port 5000, external port 80
- **Asset Serving**: Static files served from dist/public in production

## Recent Changes
- **June 25, 2025**: Fixed authentication system and API endpoints
  - Resolved all authentication errors caused by user object structure mismatch
  - Fixed `/api/logout` endpoint routing and functionality
  - Corrected user ID references from `req.user.claims.sub` to `req.user.id`
  - Improved session management and passport deserialization
  - Registration and login now working correctly with proper error handling
- **June 25, 2025**: Complete admin dashboard implementation at `/webadmin` route
  - Added comprehensive user management (role updates, activate/deactivate)
  - Added circle and will monitoring with deletion capabilities  
  - Added blog post management system with full CRUD operations
  - Added page content management for static site content
  - Implemented admin middleware with role-based access control
  - Extended database schema with blog_posts and page_contents tables
  - Added admin statistics dashboard with platform metrics
- **June 25, 2025**: Enhanced authentication flow
  - Added dedicated authentication page at `/auth` route
  - Updated landing page to redirect to auth page instead of direct login
  - Improved user onboarding experience with feature preview
- **June 25, 2025**: Improved will commitment submission flow
  - Fixed Will Details page routing and status display issues
  - Implemented 2-step guided commitment flow at `/will/:id/commit` route
  - Separated commitment submission from Will Details view for better UX
  - Added consistent flow for both initiators and members joining existing wills
  - Enhanced real-time status updates and progress tracking
- **June 25, 2025**: Implemented role-based permissions system
  - Circle level: All members are equal, no owner role or special privileges
  - Will level: Only creators can edit/delete will structure (dates, deletion)
  - Commitment level: Users can only edit their own commitments while will is pending
  - Added Edit Commitment page at `/will/:id/edit-commitment/:commitmentId` route
  - Added edit buttons for user's own commitments in Will Details view
  - Proper authorization checks for all modification operations
- **June 25, 2025**: Enhanced acknowledgment system and time displays
  - Fixed acknowledgment blocking: New wills cannot be created until all members acknowledge completion
  - Added real-time counter updates (5-second polling) for acknowledgment status
  - Refined time display: Shows minutes when less than 1 hour remaining for active wills
  - Creators can now delete active wills (but not completed ones)
  - Removed "Mark Done Today" button for active wills
  - Improved server-side status transitions with automatic updates
  - Added acknowledgment counter display to WillDetails page with real-time updates
  - Fixed toast import error in InnerCircleHub component
  - Added informational notes about acknowledgment requirements before new Will creation
  - Fixed acknowledgment system transition to properly archive completed wills when all members acknowledge
  - Made Inner Circle intro message dynamic based on member count for more personal language
- **June 26, 2025**: Enhanced privacy and user experience for commitments
  - Made "Because" statements private - only visible to the user who submitted them
  - Added visual highlighting for user's own commitment with blue background and "You" badge
  - Implemented collapsible "Why?" toggle button for user's own reason with lightbulb icon
  - Fixed toast import error in InnerCircleHub component for invite code copying
- **June 26, 2025**: Implemented Prescribed Weekly Will scheduling mode
  - Added dual scheduling options: Prescribed Weekly Will vs Custom Will in StartWill component
  - Prescribed Weekly Will automatically sets Monday 12:00 AM to Sunday 12:00 PM cycle
  - Smart date calculation: next upcoming Monday start based on current day/time
  - Enhanced Will creation flow with radio button selection and live preview of weekly schedule
  - Maintains existing Custom Will functionality for flexible date/time selection
  - Fixed React hooks violations in WillDetails component that prevented page from loading
  - Moved useState from inside map function to component level with proper state management
- **June 26, 2025**: Completely removed usernames from authentication system
  - Switched to email + password only authentication for both sign-in and sign-up
  - Updated sign-up form to collect First Name, Last Name, Email, and Password fields
  - Updated sign-in form to use Email and Password only
  - Migrated all existing user accounts to have proper first and last names
  - Removed username column from database schema completely
  - Updated all user display logic to show "First Last" format instead of usernames
  - Authentication now uses email field as the username field for Passport.js LocalStrategy
- **June 26, 2025**: Updated landing page with simplified action-driven messaging
  - Replaced "Inner Circle / Shared Commitment / Real Progress" section with streamlined content
  - New simplified cards: "Build Your Inner Circle", "Create Your Will", "Go to Work" 
  - Used bold headers with brief subheadlines for clearer user flow
  - Maintained "A space to grow with your people" section title
  - Updated both Landing.tsx (unauthenticated) and Home.tsx (authenticated) pages
- **June 26, 2025**: Simplified "Set Your Timeline" page interface and styling
  - Changed section title from "Choose Your Scheduling Mode" to "Choose Your Schedule"
  - Updated scheduling option cards: "Week Template" and "Custom" with concise descriptions
  - Replaced green celebratory styling in schedule summary with subtle grey informational styling
  - Changed "Your Weekly Schedule" to "Selected Schedule" with informative rather than confirmatory tone
  - Removed green checkmark icon and background to avoid suggesting finality before submission
- **June 26, 2025**: Enhanced UX and softened language across commitment flow screens
  - Updated progress indicator: "Dates" â†’ "When" to match Whenâ†’Whatâ†’Why flow
  - Removed "Pro Tip" sections from custom scheduling and commitment steps
  - Step 2 "What Will You Do?" updates: Changed header to "What would you like to do?" with "Cause it's as simple as wanting" subtext
  - Updated input label from "Your Commitment" to "Your Want" with new placeholder "call my grandmother this week"
  - Added 50-character limit to commitment input and removed tip styling for visual consistency
  - Step 3 "Why Does This Matter?" updates: Changed header to "Why would you like to do this?" with "Remember this when it gets tough" subtext
  - Added "Because" prefix to motivation input with new placeholder "because I like how I feel after I talk to her"
  - Added 50-character limit to motivation input and removed "Dig deep" tip section
- **June 26, 2025**: Enhanced input field experience with dynamic character counting
  - Added real-time character counters showing "X / 50" format that update with each keystroke
  - Fixed placeholder text in "Why" field from "because I like..." to "I like..." (removed redundant "because")
  - Implemented controlled input components with proper state management for character tracking
  - Ensured seamless text styling consistency between fixed prefixes and user input text
- **June 26, 2025**: Updated page titles and member display preferences
  - Changed Home page title from "Welcome to Your Growth Journey" to "Welcome" with no subtext
  - Removed "A space to grow with your people" section completely from Home page for cleaner design
  - Updated Inner Circle Hub to display member names as first names only (removed last names for privacy/simplicity)
  - Added motivational tagline "Become More â€” Together" to Inner Circle Hub header with italic and letter-spaced styling
  - Updated Auth page with simplified messaging: "Connect with the people who matter. Grow together." and concise feature descriptions
- **June 28, 2025**: Implemented comprehensive Account Settings and user management functionality
  - Added subtle user dropdown menu in Inner Circle Hub top-right corner with full name display
  - Created functional Account Settings modal with Profile Info (read-only name/email) and Security sections
  - Implemented secure password change functionality with current/new/confirm validation and 6-character minimum
  - Added Leave Circle option with confirmation dialog and safety checks for active wills
  - Added Sign Out functionality with proper session termination
  - Created backend API endpoints: `/api/change-password` and `/api/circles/leave` with authentication
  - Extended database storage with `updateUserPassword` and `removeCircleMember` methods
- **June 28, 2025**: Enhanced Will Details page with simplified Proposed Timeline section
  - Added "Proposed Timeline" section for pending wills to show proposed dates before approval
  - Displays clean Start/End date format with full weekday, date, and time information
  - Simplified layout removes redundant timeline summary while keeping essential scheduling details
  - Positioned above member commitments for better information flow during pending phase
- **June 28, 2025**: Implemented simple admin panel for internal testing
  - Added admin rights to pcguzman2000@hotmail.com user in database
  - Created Admin Panel link in user dropdown menu (only visible to admin users)
  - Added protected /admin route with access control (non-admins see "Access Denied")
  - Created simple JSON endpoints: /admin/users (all users) and /admin/wills (active wills only)
  - Minimal styling approach for internal testing and data inspection purposes
- **June 28, 2025**: Fixed acknowledgment logic for WILL completion
  - Changed acknowledgment requirements from all circle members to only committed members who participated
  - Only users who submitted commitments are now prompted to acknowledge completion
  - Fixed backend validation to prevent non-participants from acknowledging
  - Updated frontend displays to show "committed members" instead of "all members"
  - Fixed archival logic to use commitment count instead of total member count
  - Unified commitment submission UI between will creators and members joining existing wills with identical styling, icons, labels, and character limits
- **June 28, 2025**: Completed comprehensive "WILL" capitalization across entire application
  - Updated all user-facing text, buttons, headings, status messages to capitalize "WILL" when referring to the feature
  - Applied to Navigation, InnerCircleHub, StartWill, WillDetails, AdminDashboard, Landing, Auth, and EditWill pages
  - Maintained consistency across landing pages, modal dialogs, toast notifications, and admin interfaces
  - Preserved lowercase usage only when "will" is used as a verb or in descriptive text
- **June 28, 2025**: Fixed registration system database connection issue
  - Resolved "Cannot read properties of undefined (reading 'insert')" error in DatabaseStorage.createUser method
  - Added missing InsertUser type import to server/storage.ts
  - Fixed database reference inconsistencies by ensuring all methods use imported 'db' instance
  - Registration and login now working correctly with proper user creation and authentication flow
- **June 28, 2025**: Enhanced "Your Why" privacy and formatting across commitment pages
  - Added clear privacy notice with lock icon indicating "Why" statements are private and only visible to the user
  - Improved text formatting to make "Because" prefix flow seamlessly with user input
  - Applied consistent styling improvements to both StartWill and SubmitCommitment pages
  - Enhanced visual presentation with better alignment, borders, and background styling
- **June 28, 2025**: Improved acknowledgment messaging for WILL completion
  - Changed from "Waiting for committed members to acknowledge completion: X of Y" to "X of Y participating members have acknowledged"
  - Simplified requirement text from "All committed members must acknowledge before creating a new WILL" to "Required before creating a new WILL"
  - Applied consistent wording across WillDetails and InnerCircleHub pages for better clarity
- **June 28, 2025**: Streamlined WILL completion interface and user flow
  - Simplified Inner Circle Hub completed WILL section to show only "WILL Completed!" title, congratulations, and "View" button
  - Removed acknowledgment info and action from Inner Circle Hub for cleaner interface
  - Moved all acknowledgment functionality exclusively to Will Details page for focused user experience
- **June 28, 2025**: Relocated user dropdown menu for improved UX
  - Moved dropdown menu from top-right navigation to user's name in Circle Members section
  - User can now click on their own name (with chevron arrow) in the members list to access Account Settings, Leave Circle, Sign Out, and Admin Panel
  - Removed user display from top navigation bar for cleaner header design
  - Dropdown only appears for the current user, other members show as plain text
- **June 28, 2025**: Fixed comprehensive UI reactivity and cache invalidation issues
  - Resolved UI not updating without manual refresh across all components
  - Added proper cache invalidation to all mutations: WILL creation, commitment submission, editing, acknowledgments, and deletions
  - Implemented consistent query invalidation patterns for `/api/wills/circle`, `/api/circles/mine`, and specific will details queries
  - Fixed real-time updates for member lists, WILL status changes, and completion acknowledgments
  - Enhanced user experience with immediate UI feedback after all actions
- **June 29, 2025**: Enhanced commitment creation UX with "What" preview on "Why" page
  - Added preview card showing user's "What" input on the "Why would you like to do this?" step
  - Preview displays as "I will [user's input]" with clean, modern styling matching existing design
  - Implemented across both StartWill and SubmitCommitment flows for consistency
  - Preview updates automatically if user goes back to edit their "What" input
  - Improves context and flow during commitment creation process
- **June 29, 2025**: Fixed critical server startup issues and type safety improvements
  - Fixed duplicate import errors in database schema that prevented compilation
  - Resolved authentication system issues with user object handling in replitAuth.ts
  - Fixed apiRequest function signature and updated all usage throughout codebase
  - Added proper type annotations for User interface from shared schema
  - Updated pending note text: "This WILL becomes active automatically at the start date. Any member who has not submitted by then will not be included in the Will"
  - Server now running successfully with proper database connections and authentication flow
  - Fixed 100+ TypeScript errors related to API calls and user type definitions
  - Enhanced type safety while maintaining full application functionality
- **June 29, 2025**: Fixed will deletion cache invalidation for real-time UI updates
  - Enhanced will deletion mutation to invalidate all related queries comprehensively
  - Added invalidation for `/api/wills/circle`, `/api/wills/circle/${circleId}`, `/api/circles/mine`, and specific will details
  - Resolved UI lag issue where deleted wills required manual page refresh to update
  - All mutation operations now have proper cache invalidation for immediate UI feedback
- **June 29, 2025**: Implemented visual distinction for "Will" feature terminology across entire application
  - Added italic styling to "Will" when referring to the app feature using `<em>Will</em>` tags
  - Updated all major components: InnerCircleHub, StartWill, WillDetails, AdminDashboard, EditWill, Landing
  - Maintained lowercase "will" for normal grammar usage (auxiliary verb and descriptive text)
  - Applied consistent visual hierarchy to distinguish feature terminology from common language
  - Enhanced user experience with clear semantic emphasis on feature-specific references
- **June 29, 2025**: Disabled Replit authentication to enable direct public access
  - Completely removed Replit OIDC authentication system to prevent authentication gateway
  - Uninstalled openid-client and memoizee dependencies that trigger platform-level auth
  - Replaced replitAuth.ts with no-op functions to maintain compatibility
  - App now uses local email/password authentication exclusively
  - Users can access deployed app directly without requiring Replit accounts
  - Enables public sharing and user registration through app's native auth system
- **July 08, 2025**: Fixed mobile app refresh issues and enhanced End Room video functionality
  - Resolved "End Room not ready" error by fixing scheduler room creation logic
  - Added comprehensive fallback detection for missing Daily.co room URLs
  - Enhanced DailyService with improved logging and error handling
  - Implemented automatic app refresh when mobile app returns to foreground
  - Updated QueryClient configuration to enable focus-based data refresh
  - Created useAppRefresh hook for seamless mobile/web app state management
  - Data now refreshes automatically without requiring app restart
  - Fixed mobile app UI lag by setting proper staleTime (30 seconds) instead of Infinity
- **July 12, 2025**: Fixed Final Summary modal navigation issues blocking user dashboard access
  - Resolved unresponsive "X" button in Final Summary modal header
  - Fixed "Acknowledge and Close Will" button to properly handle already-acknowledged state
  - Added intelligent button behavior: acknowledges if not done, navigates to dashboard if already acknowledged
  - Enhanced error handling to prevent "already acknowledged" error messages
  - Added proper close button with X icon in modal header for better UX
  - Updated FinalWillSummary component to receive hasUserAcknowledged prop for state management
  - Users can now properly return to dashboard after Will completion without getting stuck
- **July 12, 2025**: Fixed End Room functionality and mobile compatibility issues
  - Resolved "End Room not ready" error caused by missing Daily.co room URLs in database
  - Created new Daily.co room for Will #40 with mobile-friendly configuration settings
  - Updated mobile End Room behavior to open directly in native browser for better compatibility
  - Enhanced Daily.co room properties: enabled prejoin UI, network UI for better mobile experience
  - Added device detection to automatically choose optimal video room experience (iframe vs browser)
  - Fixed mobile "Something went wrong" error by bypassing problematic iframe embedding on mobile devices
  - End Room now works seamlessly on both desktop (embedded) and mobile (native browser) platforms
  - Created MobileVideoRoom component that automatically opens video room in browser after 1 second
  - Removed inaccurate timer display that didn't reflect actual End Room duration
  - Implemented mobile-first approach that bypasses iframe limitations by opening directly in browser
  - Fixed "Something went wrong" error by avoiding problematic iframe embedding on mobile entirely
  - Integrated Capacitor InAppBrowser plugin for proper WebRTC support in native mobile apps
  - Created dedicated waiting screen that explains video room is opening in browser window
  - Added "Reopen Video Room" button for users to restart video call if needed
  - Improved user experience with clear loading states and instructions for mobile video calls
  - Enhanced error handling with multiple fallback options: Capacitor Browser â†’ window.open â†’ system browser â†’ copy URL
  - Added comprehensive platform detection to optimize video room opening based on Capacitor vs web environment
  - Implemented detailed error messages with specific troubleshooting steps for each failure scenario
  - Added manual fallback options including "Open in System Browser" and "Copy URL" for ultimate reliability
- **July 04, 2025**: Implemented Capacitor for iOS mobile app development
  - Added @capacitor/core, @capacitor/cli, and @capacitor/ios packages
  - Created capacitor.config.ts with proper iOS configuration and schemes
  - Initialized iOS platform with native Xcode project structure
  - Added mobile-optimized HTML with viewport settings and PWA meta tags
  - Created app manifest.json with proper iOS app configuration
  - Designed app icon with Inner Circles branding (connected circles motif)
  - Created build-mobile.sh script for streamlined iOS build process
  - Project now ready for iOS development and App Store submission
- **July 04, 2025**: Completed mobile app build process optimization
  - Resolved CSS build errors preventing mobile compilation (shadow-glow, hover effects)
  - Fixed development server stability issues
  - Created optimized build process that bypasses complex bundling timeouts
  - Successfully completed Capacitor iOS sync with proper asset handling
  - Created build-mobile-simple.sh for streamlined mobile builds
  - Mobile app now ready for Xcode building and device testing
  - App configured to redirect to https://willbeta.replit.app for full functionality
- **July 05, 2025**: Fixed iOS mobile UI issues and authentication system
  - Enhanced "I will" prefix visibility with white background, bold text, and proper z-index
  - Improved schedule selection visual feedback with blue highlighting and ring effects
  - Updated Week Template description text for clarity
  - Fixed authentication system for mobile app access with environment-aware cookie settings
  - Added comprehensive CORS headers for mobile app compatibility
  - Reverted to live server configuration (willbeta.replit.app) for production deployment
  - Applied fixes to both StartWill and SubmitCommitment pages for consistency
  - Fixed iOS app name display by updating CFBundleName and PRODUCT_NAME to "WILL" in both Info.plist and Xcode project settings
  - Resolved bundle identifier conflict by changing from com.will.app to com.porfirio.will to fix provisioning profile errors
  - Fixed "I will" prefix overlapping issue on iOS by restructuring input field layout with proper flexbox positioning
  - Fixed "Because" prefix overlapping issue on iOS by applying same flexbox solution to "Why" input fields
  - Updated both StartWill and SubmitCommitment pages to prevent text overlap on mobile devices
  - All input prefixes now use proper flexbox layout with flex-shrink-0 for consistent mobile display
- **July 05, 2025**: Implemented lightweight instructional modal for improved Will creation UX
  - Added WillInstructionModal component with step-by-step guidance for new users
  - Modal automatically shows for first-time Will creators and first-time commitment submitters
  - Persistent "?" help icon in StartWill and SubmitCommitment pages for easy access
  - Local storage tracking prevents repeated modal displays with optional "Don't show again" checkbox
  - Clear copy explaining When/What/Why flow with practical examples for better user onboarding
- **July 06, 2025**: Enhanced Will creation flow with End Room scheduling during creation
  - Implemented End Room scheduling as step 4 in Will creation process (not after completion)
  - Integrated Daily.co API to create video rooms automatically when Will is created
  - Added server-side End Room creation with proper error handling and status tracking
  - Updated database schema to support endRoomScheduledAt field in Will creation
- **July 06, 2025**: Redesigned End Room scheduling UX for ceremonial experience
  - Removed "End Room" from 3-step progress indicator (When â†’ What â†’ Why only)
  - Created special ceremonial 4th screen that appears after "Why" step without being in progress bar
  - Enhanced End Room interface with amber styling, larger icons, and ceremonial messaging
  - Added 48-hour time limit constraint after Will end date for End Room scheduling
  - Updated copy to "When will your circle gather to honor the efforts?" with detailed scheduling rules
  - Added comprehensive disclaimer about End Room behavior and completion criteria
- **July 06, 2025**: Enhanced Will completion flow with Final Will Summary modal
  - Implemented comprehensive Final Will Summary modal that automatically appears when Will is completed
  - Modal shows Will duration, member commitments, and End Room ceremony completion details
  - Added proper acknowledgment flow requiring user review before Will is officially archived
  - Updated Inner Circle Hub UI to show "Will Complete - Ready to Review" state with amber styling
  - Fixed pending Will note to display specific start date/time instead of generic "start date" text
- **July 06, 2025**: Enhanced End Room status displays and consistent date formatting
  - Fixed Final Will Summary to only appear after End Room ceremony actually completes (endRoomStatus === 'completed')
  - Added "End Room in Process" status with green styling when End Room is currently active
  - Updated date formatting to consistently show "Sunday, July 6, 2025 at 12:50 PM" format instead of "Tomorrow"
  - Enhanced both InnerCircleHub and EndRoom components to show exact "opens at" and "expires at" times
  - Differentiated UI states: End Room pending (purple) vs End Room active (green) vs End Room completed (amber)
  - Fixed timezone scheduling bug - End Room now correctly scheduled for 2 minutes after Will end instead of hours later
  - Updated date format to MM/DD time format (e.g., "7/6 1:22 PM") and removed "ceremony" wording
  - Simplified End Room messaging to "The End Room is live and will close at [time]"
  - Fixed redundant date formatting in Will activation text: now shows just time for today ("8:39 PM") or full date for other days ("on July 6 at 8:39 PM")
- **July 12, 2025**: Completed mobile iOS safe area optimization and layout fixes
  - Fixed critical iOS status bar overlap issue where header and user avatar were interfering with iOS system elements
  - Removed conflicting safe area CSS from #root element that was causing duplicate padding
  - Implemented proper safe area insets with `calc(env(safe-area-inset-top)+1.5rem)` for adequate clearance
  - Enhanced MobileLayout component with unified safe area handling across all mobile screens
  - Updated mobile development workflow: changes require mobile app rebuild/redeployment unlike web hot refresh
  - Fixed header spacing between title and subtitle with optimized `mt-0.5` spacing
  - Ensured native iOS feel with proper padding and layout structure throughout the app
- **July 12, 2025**: Resolved iOS build issues and established mobile development workflow
  - Fixed "No such module 'Capacitor'" error by identifying missing CocoaPods dependencies
  - Confirmed Capacitor's "App" target structure is correct by design (not an error)
  - Established live server development workflow: iOS app connects to https://willbeta.replit.app
  - Mobile app automatically receives updates from live server without requiring rebuilds
  - Verified iOS project configuration: Bundle ID (com.porfirio.will), App Name (WILL), and permissions setup
  - Documented proper build process: npm run build â†’ npx cap sync ios â†’ pod install â†’ open App.xcworkspace
- **July 12, 2025**: Fixed iOS safe area scrolling issue preventing content from sliding under status bar
  - Restructured MobileLayout component to use fixed safe area spacers instead of padding-based approach
  - Changed from `min-h-screen` to `h-screen` with proper flex container structure
  - Added fixed top safe area spacer: `h-[calc(env(safe-area-inset-top)+3rem)]` that remains visible during scroll
  - Enhanced scroll container with proper iOS-specific classes: `overflow-y-auto scroll-smooth overscroll-contain ios-scroll`
  - Implemented `[-webkit-overflow-scrolling:touch]` for native iOS scrolling behavior
  - Content now properly respects safe area boundaries during scrolling on "Choose your schedule" and all other screens
  - Fixed scroll-safe padding structure ensures content never appears under iOS status bar or system UI
  - Increased safe area clearance from 2rem to 3rem for more generous spacing above progress indicators and headers
- **July 12, 2025**: Applied comprehensive safe area handling across all mobile app screens
  - Synchronized both MobileLayout components (design-system.tsx and mobile-layout.tsx) to use consistent 3rem safe area spacing
  - Updated global CSS safe area references from 2rem to 3rem for consistency
  - Enhanced video room components with proper safe area handling for full-screen video calls
  - Added safe area spacers to SimpleVideoRoom and MobileVideoRoom components for top and bottom iOS system UI
  - Applied consistent safe area handling to all error states and loading screens across video components
  - Ensured all fixed headers, progress indicators, and full-screen components respect iOS safe area boundaries
  - Verified proper scroll behavior with `overflow-y-auto scroll-smooth overscroll-contain ios-scroll` classes throughout app
  - Maintained consistent mobile-first design approach with proper touch target sizing and iOS optimizations
- **July 12, 2025**: Enhanced help icon visibility and standardized across app
  - Created shared HelpIcon component with improved visibility and proper touch target sizing
  - Increased help icon size from small 4x4 to medium 10x10 with larger text (text-xl)
  - Added white background with shadow, border, and hover effects for better visibility
  - Standardized help icon design across StartWill and SubmitCommitment pages
  - Improved accessibility with proper button styling and consistent interaction patterns
- **July 12, 2025**: Applied consistent design system styling to Will creation "What" and "Why" steps
  - Replaced harsh blue borders with subtle gray styling using consistent design system components
  - Updated both steps to use SectionCard layout matching InnerCircleHub design language
  - Applied consistent padding, typography, and spacing conventions across all form elements
  - Replaced rigid input styling with elegant gray-to-white focus transitions and subtle shadows
  - Updated buttons to use ActionButton and PrimaryButton components with consistent rounded styling
  - Made layout more vertically compact for mobile with reduced margins and optimized icon sizing
  - Enhanced visual hierarchy with proper Lucide React icons (CheckCircle, Heart) and consistent brand colors
- **July 12, 2025**: Improved End Room scheduling screen visual hierarchy and consistency
  - Updated title styling: "Schedule Your End Room" to text-xl font-semibold with proper text-center alignment
  - Applied consistent subtitle styling: "â€¢ one last step:" as text-sm text-gray-400 and description as text-base text-gray-600
  - Standardized date input field to match "I will" and "Your Why" styling with gray-to-white focus transitions
  - Enhanced warning box with bg-red-50 border-red-300 rounded-xl styling and proper text-sm sizing for all content
  - Updated warning icons to consistent w-4 h-4 sizing and improved bullet point alignment
  - Applied text-sm font-medium styling to Back and Create Will buttons for consistency across the app
  - Replaced oversized ceremonial styling with clean, hierarchical design matching app's visual language
- **July 12, 2025**: Implemented comprehensive UI consistency improvements based on iPhone testing feedback
  - **Restored section titles**: "What would you like to do?" and "Why would you like to do this?" headers using text-xl font-semibold
  - **Standardized Back button styling**: Replaced ActionButton with consistent ghost button style (bg-white border border-gray-300)
  - **Updated input box styling**: Changed from blue-tinted backgrounds to clean white backgrounds with rounded-xl borders
  - **Improved typography hierarchy**: Headers use text-xl font-semibold, subheaders use text-sm text-gray-500
  - **Enhanced focus states**: Standardized focus:ring-2 focus:ring-blue-500 across all input fields
  - **Applied consistent spacing**: Uniform padding and margins matching Inner Circle Hub design patterns
  - **Fixed mobile compatibility**: Ensured proper iOS safe area handling and consistent touch targets
- **July 12, 2025**: Applied final polish improvements to End Room scheduling screen for optimal user experience
  - **Enhanced "One last step" visibility**: Replaced small gray text with prominent blue alert box (bg-blue-50 border-blue-100)
  - **Improved warning box typography**: Applied leading-relaxed spacing, pl-2 bullet indentation, and p-4 padding
  - **Fixed Create Will button consistency**: Added py-3 padding to match Next button vertical rhythm
  - **Added visual separation**: Implemented border-t divider above button row for cleaner action area
  - **Refined bullet point alignment**: Used mt-0.5 positioning and flex-shrink-0 for better icon alignment
  - **Polished alert messaging**: Changed from bullet point to complete sentence for clearer user guidance
  - **Fixed line break formatting**: Resolved "Willis" typo issue by using break-words class and proper list structure
  - **Optimized for single viewport**: Reduced vertical spacing (mb-6 to mb-4, space-y-6 to space-y-4) to eliminate scrolling on iPhone 13/14
  - **Enhanced bullet styling**: Replaced icons with clean circular bullets using bg-red-600 rounded-full for better readability
  - **Final spacing optimization**: Reduced bullet spacing from space-y-1.5 to space-y-0.5 for true single viewport display
  - **Updated alert messaging**: Changed "complete your Will" to "set up your Will" for better user flow accuracy
- **July 12, 2025**: Implemented comprehensive global design system with mobile-first approach
  - Created unified design system with 6 core components: MobileLayout, SectionCard, PrimaryButton, AvatarBadge, SectionTitle, ActionButton
  - Enhanced Tailwind config with global design tokens: brandGreen (#1EB854), brandBlue (#067DFD), brandGray scale
  - Added typography improvements with consistent tracking-tight and letterSpacing across all font sizes
  - Applied design system imports to all major pages: Auth, StartWill, WillDetails, InnerCircle for consistent UI patterns
  - Implemented dynamic spacing logic for content adaptation based on data length
  - Established consistent button patterns with proper hover/active states and accessibility labels
  - Fixed button text spacing issue "Start aWill" to "Start a Will" with proper JSX structure
  - Built and deployed mobile version with global design system implementation
- **July 12, 2025**: Completed Will creation flow design system implementation
  - Applied Inner Circle Hub design template to all Will creation screens: SubmitCommitment, EditCommitment, WillDetails
  - Implemented consistent MobileLayout structure with proper safe area handling for mobile iOS compatibility
  - Updated typography patterns with text-base, tracking-tight, and gap-y-4 spacing throughout
  - Enhanced form inputs with brand color schemes and proper focus states using brandBlue and brandGreen
  - Added consistent icon usage with Lucide React icons (ArrowLeft, Edit, Save, CheckCircle, Heart, Target, Clock)
  - Applied SectionCard and ActionButton components for unified interactive patterns
  - Maintained character limits (75 characters) with real-time counters across all commitment forms
  - Fixed JSX syntax issues and server compilation errors during design system migration
  - Ensured all components follow mobile-first responsive design with proper component hierarchy
- **July 13, 2025**: Implemented global toast notification improvements for iOS compatibility
  - Fixed iOS status bar overlap by updating ToastViewport positioning to use calc(env(safe-area-inset-top)+1rem)
  - Added center alignment with left-1/2 transform -translate-x-1/2 for proper mobile positioning
  - Enhanced typography consistency: title (text-base font-semibold) and description (text-sm text-gray-700)
  - Applied center text alignment to both title and description components
  - Reduced padding from p-6 pr-8 to px-4 py-3 for tighter mobile spacing
  - Added smooth animations with ease-in-out duration-300 transitions
  - Maintained responsive behavior with sm: modifiers for desktop positioning
  - Ensured all toast notifications respect iOS safe area boundaries globally across the app
- **July 13, 2025**: Enhanced toast positioning and "Why?" button interactivity for better iOS compatibility
  - Increased toast notification offset from 1rem to 3rem (calc(env(safe-area-inset-top)+3rem)) to prevent iOS status bar overlap
  - Enhanced "Why?" button styling with blue text, underline, background pill, and directional arrows (â–¼/â–²)
  - Added hover states (hover:text-blue-800, hover:bg-gray-200) and active feedback (active:opacity-70)
  - Improved visual cues with rounded background (bg-gray-100) and transition animations
  - Button now clearly indicates clickability and reveals/hides user's private "Because" statement
- **July 13, 2025**: Consolidated intro and sign-up experience for single viewport mobile display
  - **Landing Page**: Redesigned from scrollable 3-section layout to single non-scrollable mobile screen
  - Consolidated all intro content: hero section, "Build Your Inner Circle", "Create Your Will", "Go to Work" into compact single viewport
  - Reduced icon sizes, card padding, and spacing for optimal mobile fit without scrolling
  - Enhanced flow cards with horizontal layout and smaller visual elements for space efficiency
  - **Auth Page**: Streamlined sign-up/sign-in screens for single viewport display
  - Removed unnecessary "New to accountability circles?" text from sign-up page for cleaner UI
  - Compressed form elements with reduced spacing (space-y-3 instead of space-y-4)
  - Applied compact grid layout for first/last name fields to save vertical space
  - Reduced input heights (h-9) and icon sizes for tighter mobile layout
  - Maintained all functionality while achieving single screen display on iPhone 13/14
- **July 13, 2025**: Implemented dynamic Will initiator messaging in Inner Circle Hub
  - Added conditional messaging above Will Pending status block showing who started the Will
  - If viewer is creator: "You started this Will. Waiting on others to submit."
  - If viewer is not creator: "[CreatorName] has proposed a new Will."
  - Dynamically looks up creator name from circle members using will.createdBy field
  - Applied text-sm text-gray-700 mb-2 styling for consistent visual hierarchy
  - Positioned immediately above Will Pending status block for clear context
- **July 13, 2025**: Implemented comprehensive Will Details screen redesign for single viewport mobile display
  - Redesigned WillDetails page to fit entirely on single iPhone screen without scrolling across all Will states
  - Created unified compact layout with 3-4 main sections: header, timeline/end room, commitments, and actions
  - Consolidated Timeline and End Room information into single card with divider for space efficiency
  - Replaced large member commitment cards with compact list format showing checkmarks and "You" badges
  - Integrated pending members directly into commitments section with consistent styling
  - Simplified Submit Commitment section to compact centered design with smaller icon and text
  - Redesigned acknowledgment section for completed Wills to use minimal space while maintaining functionality
  - Streamlined creator actions for edit/delete into compact horizontal layout with essential information
  - Added compact Back to Hub button as simple underlined text link instead of large button
  - Maintained all existing functionality while achieving single viewport display on iPhone 13/14 screens
  - Applied consistent design system with proper spacing, typography, and mobile-first responsive patterns
- **July 13, 2025**: Completed Final Will Summary compact redesign with improved acknowledgment logic
  - Redesigned Final Will Summary modal to fit single mobile viewport without scrolling
  - Updated header to single line "âœ… Will â€“ Final Summary" with proper typography hierarchy
  - Merged Will Duration and End Room into compact duration block with emoji icons (ðŸ•“ðŸ“¹) and clean formatting
  - Restructured member commitments to use two-line format: name on first line, commitment text on second line with proper spacing
  - Fixed acknowledgment button logic: "Acknowledge" button only registers user's acknowledgment without closing modal
  - Separated acknowledgment action from modal close: "Back to Hub" button serves as actual close/navigation
  - Enhanced vertical spacing between sections (space-y-4, mb-4) for better visual hierarchy
  - Removed duration calculations and parentheses from time displays to reduce visual clutter
  - Applied consistent mobile-first design patterns with proper touch targets and readability
- **July 13, 2025**: Final Will Summary screen refinements based on user feedback
  - Removed X button from dialog by hiding it with CSS selector [&>button]:hidden
  - Removed emoji icons from Will and End Room labels for cleaner visual design
  - Updated title structure: "Will: Complete" as main title with "Final Summary" as subtitle
  - Ensured single-line display for Will and End Room details without line breaks
  - Maintained proper acknowledgment flow: "Acknowledge" button only registers acknowledgment, "Back to Hub" handles navigation
  - Enhanced title hierarchy by positioning title and subtitle above the Will/End Room container
- **July 13, 2025**: Fixed action button spacing issues across all Inner Circle Hub summary cards
  - Added proper vertical spacing (mt-3 mb-3) and horizontal padding (px-4) to all primary action buttons
  - Fixed cramped "ViewWillDetails" button spacing by wrapping buttons in spacing containers
  - Applied consistent spacing to "Start a Will", "View Will Details", "Join End Room", and "Review Final Summary" buttons
  - Enhanced button readability and touch targets for better mobile user experience
  - Established universal spacing rule for all summary screen action buttons to maintain clean, readable layout
- **July 13, 2025**: Refined Step 1 and Step 2 commitment flow screens with elevated visual design
  - **Removed redundant info boxes**: Eliminated "Duration" and "Status" sections from SubmitCommitment flow to reduce clutter
  - **Beautified "I will..." preview**: Replaced plain text with styled, non-editable card using italic text-lg with border and shadow
  - **Tightened header spacing**: Moved "Step X of 2" to text-sm text-gray-400 mb-1 above section titles for better hierarchy
  - **Improved layout consistency**: Applied space-y-3 vertical spacing throughout both StartWill and SubmitCommitment flows
  - **Refined icon sizing**: Reduced icon containers from w-12 h-12 to w-10 h-10 for cleaner, more proportional feel
  - **Enhanced commitment preview**: Used consistent "I will [commitment]" format with elegant card styling across both flows
- **July 13, 2025**: Implemented smooth transition animations and refined End Room scheduling UX
  - **Added uplifting interstitial animations**: Implemented 2.5-second transition screen after "Why" step completion with "One last step before you set up your Will..." message
  - **Enhanced End Room scheduling screen**: Replaced blue alert box with elegant descriptive text "This is where your circle comes together to reflect, share, and honor the effort"
  - **Tightened warning box spacing**: Reduced vertical spacing from space-y-0 to space-y-1 in red info box for better mobile layout
  - **Added custom CSS animations**: Created fadeIn and slideUp keyframe animations with proper timing for smooth UX transitions
  - **Applied consistent animation logic**: Both StartWill and SubmitCommitment pages now use identical transition animation patterns
  - **Improved mobile flow**: Animations enhance the commitment submission process with professional, polished feel optimized for iOS app
- **July 13, 2025**: Redesigned Current Will section with elegant hierarchical layout for consistent user experience
  - **Unified pending Will design**: Replaced stacked visual elements with center-aligned card layout using single border and shadow
  - **Improved information hierarchy**: Primary info (creator name) â†’ Secondary (Will Pending status) â†’ Tertiary (submission progress and timing)
  - **Consistent cross-user experience**: All users see "[Name] proposed a new Will" format regardless of creator/member status
  - **Streamlined visual weight**: Replaced large icons and badges with compact Clock icon and simplified status display
  - **Mobile-optimized layout**: Reduced visual clutter with compact yellow info box and proper spacing for single viewport display
  - **Enhanced readability**: Applied consistent text sizing (text-sm, text-xs) and color hierarchy (gray-600, gray-700, yellow-600)
- **July 13, 2025**: Enhanced Circle Commitments layout in Will Details screen for improved mobile readability
  - **Restructured commitment display**: Implemented clean stacked format with user name, "I will" label, and user content on separate lines
  - **Improved visual hierarchy**: Added italic font styling for "I will" and "Because" labels to distinguish from user content
  - **Enhanced button functionality**: Replaced text-based Edit button with compact Edit icon, simplified show/hide toggle to directional arrows only
  - **Optimized spacing**: Added proper padding between sections (space-y-3, pt-3) and improved line spacing with leading-relaxed
  - **Consistent mobile layout**: Applied improvements uniformly across all Will phases (pending, scheduled, active, completed)
  - **Better touch targets**: Improved button sizing and spacing for mobile interaction while maintaining clean appearance
- **July 13, 2025**: Refined Will Details screen typography and layout hierarchy for consistent visual design
  - **Standardized font hierarchy**: Unified secondary text to text-xs (badges, timestamps, helper text) and section headers to text-sm font-medium
  - **Consistent section spacing**: Applied uniform mb-3 spacing to all section headers (Timeline, End Room, Circle Commitments)
  - **Cleaned pending status display**: Removed duplicate pending member rows, consolidated to single "X / Y members submitted" counter
  - **Improved readability**: Reduced submission helper text contrast (text-gray-500) to avoid competing with main action button
  - **Streamlined layout**: Eliminated redundant visual elements while maintaining clear information hierarchy
- **July 13, 2025**: Refined Auth screen layout for improved mobile elegance and reduced visual clutter
  - **Optimized card styling**: Replaced SectionCard with custom rounded-xl card using px-4 py-6 padding for better breathability
  - **Reduced vertical spacing**: Tightened feature bullet spacing from space-y-3 to space-y-2, header spacing from space-y-2 to space-y-1
  - **Enhanced disclaimer presentation**: Added pt-3 spacing above privacy notice, reduced to text-gray-400 font-light for subtlety
  - **Maintained one-pager design**: Preserved compact single-viewport layout while improving visual hierarchy and readability
  - **Improved form consistency**: Applied consistent space-y-3 spacing throughout authentication forms for cleaner stacking
- **July 06, 2025**: Implemented proper Will lifecycle and End Room completion flow
  - Fixed Will status transitions with new "waiting_for_end_room" status between Will end and End Room completion
  - Added comprehensive scheduler logic for Will lifecycle: pending â†’ active â†’ waiting_for_end_room â†’ completed
  - Enforced End Room scheduling validation rules: must be scheduled between Will end time and 48 hours afterward
  - Added client-side and server-side validation with clear error messages for invalid End Room times
  - Created dedicated UI for "waiting_for_end_room" status in Inner Circle Hub with purple styling and video icon
  - Fixed End Room completion logic: Wills only complete when End Room expires, not when Will end date passes
  - Updated End Room info text to clarify 30-minute duration, no rescheduling, and automatic completion policies
- **July 06, 2025**: Fixed comprehensive timezone handling for End Room scheduling
  - Fixed End Room scheduling to properly convert user's local time to UTC before database storage
  - Updated End Room display formatting to show times in user's local timezone from stored UTC timestamps
  - Fixed scheduler logic to compare UTC times correctly for status transitions
  - Implemented consistent timezone rules: store UTC in database, display local time in frontend
  - Fixed 7-hour timezone offset issue that was incorrectly scheduling End Rooms
  - Updated formatEndRoomTime function to handle proper UTC-to-local conversion without manual string manipulation
- **July 06, 2025**: Completed timezone and End Room functionality with working Daily.co integration
  - Resolved Daily.co API authentication by setting up billing and providing working API key
  - Fixed Daily.co API parameter issue ("unknown parameter 'config'") that was preventing room creation
  - End Room lifecycle working perfectly: Will ends â†’ End Room active â†’ End Room expires â†’ Will completed
  - Timezone conversion working correctly: UTC storage with local time display throughout app
  - Smart time formatting: shows just time for today ("9:17 PM") or date+time for other days applied to all date displays
  - Scheduler automatically transitions Will status and closes End Rooms at proper times
  - Video room creation working: automatic during Will creation + fallback creation via "Join" button
  - Final Will Summary modal appears when End Room ceremony completes for acknowledgment flow
  - Updated End Room scheduling page with ceremonial wording and clear constraints ("honor the effort")
  - Fixed Daily.co room access permissions with enhanced public settings (enable_knocking: false, enable_prejoin_ui: false)
  - Updated End Room button from "Create Video Room" to "Join" with green styling for better UX
  - Restructured "Awaiting End Room" page to show "Will Complete" with "Pending End Room" status
  - Added End Room explanation text and Scheduled End Room section with start/end times
  - Removed duration text from date display for cleaner waiting for End Room interface
  - Standardized all character limits to 75 characters across StartWill, SubmitCommitment, and EditCommitment pages
  - Added real-time character counters showing "X / 75" format for consistent user experience
  - Removed "ceremony" terminology from End Room feature across all components
  - Updated End Room formatting to match Will Duration format with "Started:" and "Ended:" labels
  - Changed "Attendees:" to "Participants:" and added consistent grid layout and duration display
- **July 07, 2025**: Enhanced Will Details consistency and fixed critical scheduler bug
  - Made Will Details page consistent across all statuses (pending, scheduled, active, waiting_for_end_room, completed)
  - Added Will Duration section and End Room Meeting details for scheduled, active, and other non-pending statuses
  - Fixed critical scheduler bug where Wills were skipping the proper lifecycle transitions
  - Root cause: Scheduler only handled 'pending' and 'active' statuses, missing 'scheduled' status in transition logic
  - Updated scheduler to properly handle 'scheduled' status transitions: scheduled â†’ active â†’ waiting_for_end_room â†’ completed
  - Wills now correctly follow End Room flow instead of bypassing waiting_for_end_room status
  - Added proper status transition logic with OR conditions to handle both 'pending' and 'scheduled' starting states
- **July 07, 2025**: Implemented advanced embedded video room with mobile optimization and permissions handling
  - Created AdvancedVideoRoom component using iframe approach for better mobile compatibility
  - Added Capacitor device detection to optimize experience for iOS/Android vs web
  - Implemented proper iOS WebView permissions for camera and microphone access
  - Added comprehensive fallback system: embedded iframe â†’ native browser â†’ external tab
  - Enhanced video room with auto-disconnect timer (30 minutes) and real-time countdown
  - Added iOS-specific configuration for camera/microphone permissions in Info.plist
  - Created mobile build script with video room support and permission setup
  - Fixed mobile video call errors by replacing embedded Daily.co SDK with iframe approach
  - Video room now works reliably across all platforms with appropriate permission handling

## Changelog
- June 25, 2025. Initial setup
- June 25, 2025. Admin dashboard completed with full platform management

## User Preferences

Preferred communication style: Simple, everyday language.

## Role and Permission Rules
- **Circle Level**: All members are equal, no special "owner" role or privileges for circle creator
- **Will Level**: Only the will creator can edit start/end dates or delete the will
- **Commitment Level**: Each user can only edit their own commitment ("I will..." and "Because...")
- **Status Restrictions**: Wills and commitments can only be modified while status is "pending"