[Log] Router debug [iPhone]: â€“ {isAuthenticated: true, isLoading: false, user: "17511021851866udaucmnr", â€¦} (index-BTI5CFsX.js, line 298)
{isAuthenticated: true, isLoading: false, user: "17511021851866udaucmnr", location: "/hub"}Object
[Log] Router debug [iPhone]: â€“ {isAuthenticated: true, isLoading: false, user: "17511021851866udaucmnr", â€¦} (index-BTI5CFsX.js, line 298)
{isAuthenticated: true, isLoading: false, user: "17511021851866udaucmnr", location: "/hub"}Object
> // WILL Push Notification Test - UPDATED
console.log('ğŸ”” WILL Push Notification Test - Starting...');
console.log('ğŸ“± Make sure you granted notification permission when prompted');

// Test 1: Check if user is logged in and device registered
async function checkDeviceStatus() {
  try {
    console.log('ğŸ” Testing /api/auth/me endpoint...');
    const authResponse = await fetch('/api/auth/me');
    if (!authResponse.ok) {
      console.log('âŒ Not logged in - please sign in first');
      return null;
    }
    
    const user = await authResponse.json();
    console.log('âœ… User logged in:', user.firstName, user.lastName);
    
    const statusResponse = await fetch('/api/notifications/status');
    const status = await statusResponse.json();
    console.log('ğŸ“± Device status:', status);
    
    return user.id;
  } catch (error) {
    console.log('âŒ Connection error:', error.message);
    return null;
  }
}

// Test 2: Send a simple test notification
async function sendTestNotification(userId) {
  try {
    console.log('ğŸ“¤ Sending test notification...');
    const response = await fetch('/api/notifications/test', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        userId: userId,
        title: 'WILL Test',
        body: 'Push notifications are working! ğŸ‰'
      })
    });
    
    const result = await response.json();
    console.log('ğŸ“¬ Test result:', result);
    
    if (result.success) {
      console.log('âœ… SUCCESS: Check your iPhone for the notification!');
      return true;
    } else {
      console.log('âŒ FAILED:', result.error);
      return false;
    }
  } catch (error) {
    console.log('âŒ Test failed:', error.message);
    return false;
  }
}

// Run the test
async function runTest() {
  console.log('='.repeat(50));
  console.log('WILL PUSH NOTIFICATION TEST');
  console.log('='.repeat(50));
  
  const userId = await checkDeviceStatus();
  if (!userId) {
    console.log('ğŸ›‘ STOP: Please log into the app first');
    return;
  }
  
  console.log('â³ Sending test notification in 3 seconds...');
  await new Promise(resolve => setTimeout(resolve, 3000));
  
  const success = await sendTestNotification(userId);
  
  console.log('='.repeat(50));
  if (success) {
    console.log('ğŸ‰ TEST PASSED: You should see a notification on your iPhone');
    console.log('ğŸ“± If you see the notification, push notifications are WORKING!');
  } else {
    console.log('âŒ TEST FAILED: Check server logs for errors');
  }
  console.log('='.repeat(50));
}

// Auto-start test
runTest();
[Log] ğŸ”” WILL Push Notification Test - Starting...
[Log] ğŸ“± Make sure you granted notification permission when prompted
[Log] ==================================================
[Log] WILL PUSH NOTIFICATION TEST
[Log] ==================================================
[Log] ğŸ” Testing /api/auth/me endpoint...
< Promise {status: "pending"}
[Log] âœ… User logged in: â€“ "Randy" â€“ "Orton"