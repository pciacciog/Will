DEEP DIAGNOSTIC: Why Is "Your circle already has an active will" Still Appearing?

Hey! The error is still happening after the attempted fix. We need to do a comprehensive diagnostic to find out exactly where this check is failing.

CURRENT SITUATION:
- I'm in Circle B (circleId = ?)
- Circle B has NO active Will (I can see this in the UI)
- Circle A (circleId = ?) has an active Will scheduled for Jan 19
- When I try to create a Will in Circle B, I get 400: "Your circle already has an active will"

STEP-BY-STEP DIAGNOSTIC NEEDED:

1. VERIFY WHICH CIRCLE I'M IN:
   - When I'm in Circle B's hub, can you log/show me what circleId is being passed?
   - Is the frontend correctly identifying which circle I'm trying to create a Will in?
   - Add console.log in the frontend to show: "Creating Will in circleId: [X]"

2. API REQUEST INSPECTION:
   - When I click "Start a Will", what API request is made?
   - What's the exact endpoint? (POST /api/wills/create? POST /api/wills?)
   - What data is being sent in the request body?
   - Is circleId being sent in the request? Show me the payload.

3. BACKEND VALIDATION CODE:
   - Show me the EXACT code that's checking for active Wills
   - What file is this in?
   - What line numbers?
   - Paste the actual code here so I can see it

4. DATABASE QUERY:
   - What SQL/database query is being run to check for active Wills?
   - Is it filtering by circleId?
   - Can you show me the actual query being executed?
   - Add logging to show: "Checking for active Will in circleId: [X]"

5. WHAT IS "ACTIVE"?:
   - How is an "active" Will defined in the code?
   - Status = 'active'?
   - Status = 'scheduled'?
   - Status IN ('pending', 'scheduled', 'active')?
   - Maybe the check is including TOO MANY statuses?

6. ACTUAL DATA CHECK:
   - Can you query the database directly and show me:
     * All Wills in Circle A (with their status)
     * All Wills in Circle B (with their status)
     * Any Wills associated with my userId
   - Let's see the raw data to understand what's happening

7. MULTIPLE VALIDATION POINTS?:
   - Is there more than one place checking for active Wills?
   - Could there be validation happening in:
     * Frontend (before sending request)
     * API route handler
     * Storage layer
     * Database constraint
   - Maybe you fixed one but not all?

DEBUGGING STEPS:

Please add extensive logging and show me the output:
```javascript
// In the Will creation endpoint
console.log('=== WILL CREATION DEBUG ===');
console.log('User ID:', userId);
console.log('Circle ID from request:', req.body.circleId);
console.log('Checking for active Will in circle:', circleId);

// Before the check
const activeWills = await storage.getActiveWillsForCircle(circleId);
console.log('Active Wills found in this circle:', activeWills);

const allUserWills = await storage.getAllWillsForUser(userId);
console.log('All Wills for this user (any circle):', allUserWills);

// Show what the check is actually doing
console.log('Is circleId being used in the check?', [show the actual check]);
```

SPECIFIC QUESTIONS:

1. Did you create a NEW function `getCircleActiveWill(circleId)` or are you still using an old function?
2. Show me the storage layer function that's checking for active Wills
3. Is the circleId definitely being passed from frontend → backend → database?
4. Could there be a typo in column names? (circle_id vs circleId vs circle?)
5. Is there any caching that might be returning stale data?

POSSIBLE ROOT CAUSES:

A. The fix wasn't actually deployed
B. The fix was applied to the wrong endpoint
C. Multiple validation points, only one was fixed
D. circleId is not being passed correctly
E. The query is still filtering by userId instead of circleId
F. The definition of "active" is too broad (includes scheduled, pending, etc.)
G. Frontend is passing wrong circleId
H. Database has orphaned data causing issues

WHAT I NEED:

1. Show me the CURRENT code (after your attempted fix)
2. Show me the logs from the diagnostic statements above
3. Show me the raw database data for both circles
4. Show me the frontend code that calls the API
5. Confirm the circleId is being passed through the entire chain

Let's trace this through step by step until we find where it's breaking!